<html>
  <head>
    <link rel="stylesheet" href="../../core/render_stage.css" />
    <script src="https://unpkg.com/blob-util/dist/blob-util.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/gsap.min.js"></script>
    <script src="../lib/gif.js"></script>
    <script src="//d3plus.org/js/d3.js"></script>
    <script src="//d3plus.org/js/d3plus.js"></script>
  </head>

  <body>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 216 216">
      <defs>
        <style>
          .cls-1 {
            fill: #814f2b;
          }
          .cls-2 {
            fill: #925932;
          }
          .cls-3 {
            fill: #a4683f;
          }
          .cls-4 {
            fill: #d69e6d;
          }
          .cls-5 {
            fill: #b47947;
          }
          .cls-6 {
            fill: #3e1d11;
          }
          .cls-7 {
            fill: #562d15;
          }
          .cls-8 {
            font-size: 15px;
            fill: #b760c2;
            stroke: #b760c2;
            stroke-miterlimit: 10;
            stroke-width: 0.5px;
          }
          .cls-10,
          .cls-8,
          .cls-9 {
            font-family: MyDearWatson-Regular, My Dear Watson;
          }
          .cls-9 {
            font-size: 23px;
            fill: #f1c40f;
            stroke: #f1c40f;
            stroke-width: 0.65px;
          }
          .cls-10,
          .cls-9 {
            stroke-linecap: round;
            stroke-linejoin: round;
          }
          .cls-10 {
            font-size: 14.7px;
            fill: #7d141c;
            stroke: #7d141c;
            stroke-width: 0.5px;
          }
        </style>
      </defs>
      <g id="sticker">
        <path
          class="cls-1"
          d="M155.37,157a38.64,38.64,0,0,1-38.59-38.6c0-.93,0-1.83.09-2.69a38.54,38.54,0,0,1,38.5-35.9,38.68,38.68,0,0,1,38.5,35.93c.06.78.09,1.6.1,2.45v.21A38.65,38.65,0,0,1,155.37,157Z"
        />
        <path fill="#0a0a0a"
          d="M155.37,80.54a37.86,37.86,0,0,1,37.76,35.23c.05.79.08,1.6.09,2.41v.2a37.85,37.85,0,1,1-75.69,0c0-.88,0-1.76.09-2.63a38.25,38.25,0,0,1,1.4-7.93,37.86,37.86,0,0,1,36.35-27.28m0-1.5a39.54,39.54,0,0,0-37.79,28.36,38.58,38.58,0,0,0-1.45,8.24c-.07.87-.1,1.8-.1,2.74a39.35,39.35,0,1,0,78.69,0v-.2c0-.88,0-1.72-.1-2.52A39.43,39.43,0,0,0,155.37,79Z"
        />
        <path
          class="cls-2"
          d="M193.13,117.93a37.84,37.84,0,0,1-75.51,0c0-.49.08-1,.13-1.46a37.85,37.85,0,0,1,75.25,0C193.05,117,193.09,117.44,193.13,117.93Z"
        />
        <path
          class="cls-3"
          d="M193,116.32a37.84,37.84,0,0,1-75.25,0,38.26,38.26,0,0,1,1.27-6.46,37.85,37.85,0,0,1,74,6.48Z"
        />
        <path
          class="cls-4"
          d="M193.22,118.18c-.07.2-.12.4-.18.61a37.86,37.86,0,0,1-73.84-7.45c-.11-1.16-.17-2.33-.18-3.52a37.85,37.85,0,0,1,74.2,10.36Z"
        />
        <path
          class="cls-5"
          d="M193,118.79a37.86,37.86,0,0,1-73.84-7.45A37.86,37.86,0,0,1,193,118.79Z"
        />
        <ellipse class="cls-6" cx="148.92" cy="90.09" rx="2.23" ry="2.22" />
        <ellipse class="cls-6" cx="160.76" cy="93.09" rx="3.9" ry="3.88" />
        <ellipse class="cls-6" cx="153.36" cy="100.88" rx="2.14" ry="2.13" />
        <ellipse class="cls-6" cx="139.99" cy="97.6" rx="2.41" ry="2.4" />
        <ellipse class="cls-6" cx="133.47" cy="104.33" rx="3.06" ry="3.04" />
        <ellipse class="cls-6" cx="141.89" cy="115.71" rx="4.28" ry="4.26" />
        <ellipse class="cls-6" cx="128.4" cy="116.47" rx="2.87" ry="2.85" />
        <ellipse class="cls-6" cx="156.86" cy="113.92" rx="3.47" ry="3.45" />
        <ellipse class="cls-6" cx="141.89" cy="131.61" rx="3.55" ry="3.53" />
        <ellipse class="cls-6" cx="134.55" cy="139.9" rx="2.22" ry="2.21" />
        <ellipse class="cls-6" cx="150.55" cy="144.26" rx="3.4" ry="3.38" />
        <ellipse class="cls-6" cx="156.86" cy="149.76" rx="2.24" ry="2.23" />
        <ellipse class="cls-6" cx="161.09" cy="136.87" rx="1.94" ry="1.93" />
        <ellipse class="cls-6" cx="173.51" cy="140.69" rx="2.47" ry="2.45" />
        <ellipse class="cls-6" cx="170.18" cy="131.14" rx="3.12" ry="3.1" />
        <ellipse class="cls-6" cx="175.71" cy="117.12" rx="3.12" ry="3.1" />
        <ellipse class="cls-6" cx="182.71" cy="124.37" rx="2.15" ry="2.14" />
        <ellipse class="cls-6" cx="169.09" cy="111.28" rx="2.37" ry="2.35" />
        <ellipse class="cls-6" cx="177.75" cy="101.98" rx="2.79" ry="2.77" />
        <ellipse class="cls-6" cx="157.41" cy="124.77" rx="2.24" ry="2.23" />
        <circle class="cls-7" cx="148.97" cy="89.3" r="2.22" />
        <circle class="cls-7" cx="160.75" cy="92.3" r="3.88" />
        <circle class="cls-7" cx="153.4" cy="100.1" r="2.13" />
        <circle class="cls-7" cx="140.11" cy="96.82" r="2.4" />
        <circle class="cls-7" cx="133.62" cy="103.54" r="3.04" />
        <circle class="cls-7" cx="141.99" cy="114.93" r="4.26" />
        <circle class="cls-7" cx="128.58" cy="115.68" r="2.85" />
        <circle class="cls-7" cx="156.88" cy="113.13" r="3.45" />
        <circle class="cls-7" cx="141.99" cy="130.82" r="3.53" />
        <circle class="cls-7" cx="134.7" cy="139.12" r="2.21" />
        <circle class="cls-7" cx="150.61" cy="143.47" r="3.38" />
        <circle class="cls-7" cx="156.88" cy="148.98" r="2.23" />
        <circle class="cls-7" cx="161.08" cy="136.08" r="1.93" />
        <circle class="cls-7" cx="173.43" cy="139.9" r="2.45" />
        <circle class="cls-7" cx="170.11" cy="130.35" r="3.1" />
        <circle class="cls-7" cx="175.62" cy="116.33" r="3.1" />
        <circle class="cls-7" cx="182.58" cy="123.58" r="2.14" />
        <circle class="cls-7" cx="169.03" cy="110.49" r="2.35" />
        <circle class="cls-7" cx="177.64" cy="101.19" r="2.77" />
        <circle class="cls-7" cx="157.42" cy="123.98" r="2.23" />
        <text id="unit" class="cls-8" transform="translate(108 73.57)">
          ~150 calories
        </text>
        <!-- <text class="cls-9" transform="translate(30.37 85.38)">
          <tspan id="value">532</tspan>
          <tspan id="unit" x="0" y="20">calories</tspan>
        </text>

        <rect fill="none" x="30" y="112" width="80" height="65" />
        <text fill="#0a0a0a" id="text" class="cls-10 wrap"></text> -->
        <!-- <text class="cls-10" transform="translate(42.81 120.25)">
          <tspan id="analogy_text">3.5 x a</tspan>
          <tspan x="0" y="15">chocolate</tspan>
          <tspan x="0" y="30">chip cookie</tspan>
        </text> -->

        <rect fill="none" x="24" y="60" width="65" height="95"></rect>
        <text id="text" font-size="20px" class="cls-9 wrap"></text>

        <rect fill="none" x="24" y="165" width="155" height="30"></rect>
        <text id="analogy" class="cls-10 wrap"></text>

      </g>
    </svg>

    <section></section>

    <script>
      var totalNutrients = {"calories": 150, "g fiber": 1, "g carbs": 20, "g sodium": 90, "g sugar": 10};
      var denominatorRoot = "a chocolate chip cookie";
      var denominatorDescriptor;
      var unit = new URL(window.location.href).searchParams.get("unit");
      var value = new URL(window.location.href).searchParams.get("value");
      if(unit in totalNutrients) {
      denominatorValue = totalNutrients[unit];
      denominatorDescriptor = ' x ' + denominatorRoot;
    } else {
      denominatorValue = totalNutrients['calories'];
      denominatorDescriptor = " " + unit + ' per calorie of ' + denominatorRoot;
    }
      var analogy_value = (value/denominatorValue).toFixed(1) + " " + unit;
      var sel = document.querySelector('#analogy');
      sel.textContent = (value/denominatorValue).toFixed(1)  + denominatorDescriptor;

      var unitSel = document.querySelector('#unit');
      if(unit in totalNutrients) {
        unitSel.textContent = "~" + denominatorValue + " " + options['unit'];
      } else {
        unitSel.textContent = "~" + denominatorValue + " calories";
      }

    </script>
    <script src="../lib/moment.js"></script>
    <script src="../core/timeparser.js"></script>
    <script src="../core/textwrap.js"></script>
    <script src="../core/options.js"></script>
    <script src="../core/render.js"></script>
  </body>
</html>
